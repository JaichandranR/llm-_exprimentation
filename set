- id: prepare_dates
  type: io.kestra.core.tasks.debugs.Return
  format: >
    [
      {% set today = now() %}
      {% if today | date('u') != '6' and today | date('u') != '7' %}
        "{{ today | date('yyyy-MM-dd') }}",
      {% endif %}

      "{{ today | date('yyyy-MM-01') }}",

      {% for i in range(1, 7) %}
        {% set d = now() | dateAdd(-i, 'MONTHS') %}
        {% set dow = d | date('u') %}
        {% if dow != '6' and dow != '7' %}
          "{{ d | date('yyyy-MM-01') }}",
        {% endif %}
      {% endfor %}
    ]
