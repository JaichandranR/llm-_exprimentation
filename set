{% macro extract_status_columns(json_column, keys) %}
    {% for key in keys %}
        cast(
            regexp_extract(
                {{ json_column }},
                '"{{ key }}"\\s*:\\s*"?(\\d+)"?',
                1
            ) as integer
        ) as {{ key | lower | replace('-', '_') }}
        {% if not loop.last %},{% endif %}
    {% endfor %}
{% endmacro %}
