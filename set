- id: prepare_dates
  type: io.kestra.core.tasks.debugs.Return
  format: >
    {{
      result = [];
      now_u = now() | date('u');
      if (now_u != '6' and now_u != '7') {
        result.add({ "index": result.size(), "date": now() | date('yyyy-MM-dd') });
      }
      m1 = now() | date('yyyy-MM-01');
      m1_u = m1 | date('u');
      if (m1_u != '6' and m1_u != '7') {
        result.add({ "index": result.size(), "date": m1 });
      }
      for i in range(1, 7) {
        d = now() | dateAdd(-i, 'MONTHS') | date('yyyy-MM-01');
        d_u = d | date('u');
        if (d_u != '6' and d_u != '7') {
          result.add({ "index": result.size(), "date": d });
        }
      }
      result | toJson
    }}
