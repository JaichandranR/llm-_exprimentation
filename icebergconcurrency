What Happens If You Run dbt run (Trino) + Delete Records (Glue Spark) at the Same Time?

Iceberg supports multi-writer concurrency, but only when both engines follow Icebergâ€™s commit protocol correctly.
However, issues arise if:

1. Two writers update the same snapshot concurrently

Trino (dbt) produces a new Iceberg snapshot when it inserts/merges.

Glue Spark produces a new snapshot when it deletes.

If these two commits happen at the exact same time, only one will succeed and the other will fail with:

CommitFailedException

Validation failed

ConcurrentModificationException

Cannot commit the snapshot because base snapshot has changed

This is expected behavior in Iceberg to prevent corruption.

Trino does not automatically retry commits, so your dbt run may fail.
