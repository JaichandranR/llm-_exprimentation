SELECT 
    committed_at,
    operation,
    concat('"', CAST(snapshot_id AS VARCHAR), '",') AS formatted_id
FROM cosmos_nonhdc_iceberg.common_data."fnd_fct_stg_review$snapshots"
ORDER BY committed_at;

{% set snapshot_ids = [
    "1716685161104003335",
    "310896619443653638",
    "5048195014127461821",
    "912246503241938511",
    "3979872208906135786",
    "1489425741387890888"
] %}

{% for sid in snapshot_ids %}
SELECT '{{ sid }}' AS snapshot_id,
       COUNT(*) AS count_record,
       {{ loop.index }} AS order_col
FROM cosmos_nonhdc_iceberg.common_data.fnd_fct_stg_review
FOR VERSION AS OF {{ sid }}
{% if not loop.last %} UNION ALL {% endif %}
{% endfor %}
