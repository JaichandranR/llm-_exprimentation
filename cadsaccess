-- macros/print_args.sql

{% macro print_all_args(**kwargs) %}

  {{ log("Received arguments:", info=True) }}

  {% if kwargs %}
    {% for key, value in kwargs.items() %}
      {{ log("  " ~ key ~ ": " ~ value, info=True) }}
    {% endfor %}
  {% else %}
    {{ log("  No arguments received.", info=True) }}
  {% endif %}

{% endmacro %}

dbt run-operation print_all_args --args '{message: "Hello from dbt!", user: "data_analyst", environment: "staging"}'

