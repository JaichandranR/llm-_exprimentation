import boto3
from botocore.exceptions import ClientError

# Define the S3 bucket name
s3_bucket = "your-glue-warehouse-bucket"  # Replace with your actual bucket name

def list_s3_objects(bucket):
    """ List all objects in an S3 bucket """
    try:
        s3_client = boto3.client("s3")
        response = s3_client.list_objects_v2(Bucket=bucket)

        if "Contents" in response:
            print(f"\nâœ… Found {len(response['Contents'])} objects in {bucket}:")
            for obj in response["Contents"]:
                print(f" - {obj['Key']} (Size: {obj['Size']} bytes)")
        else:
            print(f"\n[ERROR] No objects found in {bucket}.")

    except ClientError as e:
        print(f"[ERROR] S3 Access Error: {e}")
