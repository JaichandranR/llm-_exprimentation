{% macro get_schema_location(schema_name) %}
  {% set ddl_query %}
    SHOW CREATE SCHEMA {{ schema_name }}
  {% endset %}

  {% set ddl_result = run_query(ddl_query) %}
  {% set ddl_text = ddl_result.columns[0].values()[0] %}
  {% set ddl_lines = ddl_text.split('\n') %}

  {% set location_line = '' %}
  {% for line in ddl_lines %}
    {% if 'location' in line %}
      {% set location_line = line %}
    {% endif %}
  {% endfor %}

  {% set location = location_line.split("'")[1] %}
  {{ return(location) }}
{% endmacro %}
