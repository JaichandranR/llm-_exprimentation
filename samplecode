- id: prepare_6_months_dates
  type: io.kestra.core.tasks.debugs.Return
  format: >
    {% set include_current = now() | date("dd") != "01" %}
    {
      "months": [
        {% if include_current %}
          "{{ now() | date("yyyy-MM-01") }}",
        {% endif %}
        "{{ dateAdd(-1, 'MONTHS') | date("yyyy-MM-01") }}",
        "{{ dateAdd(-2, 'MONTHS') | date("yyyy-MM-01") }}",
        "{{ dateAdd(-3, 'MONTHS') | date("yyyy-MM-01") }}",
        "{{ dateAdd(-4, 'MONTHS') | date("yyyy-MM-01") }}",
        "{{ dateAdd(-5, 'MONTHS') | date("yyyy-MM-01") }}",
        "{{ dateAdd(-6, 'MONTHS') | date("yyyy-MM-01") }}"
      ]
    }


- id: test_months_output
  type: io.kestra.plugin.core.log.Log
  message: "Months Output: {{ outputs.prepare_6_months_dates.value.months }}"
