- id: prepare_6_months_dates
  type: io.kestra.core.tasks.debugs.Return
  format: >
    {% set include_current = now().format('dd') != "01" %}
    {
      "months": [
        {% if include_current %}
          "{{ now().withDayOfMonth(1).format('yyyy-MM-01') }}",
        {% endif %}
        "{{ now().plusMonths(-1).withDayOfMonth(1).format('yyyy-MM-01') }}",
        "{{ now().plusMonths(-2).withDayOfMonth(1).format('yyyy-MM-01') }}",
        "{{ now().plusMonths(-3).withDayOfMonth(1).format('yyyy-MM-01') }}",
        "{{ now().plusMonths(-4).withDayOfMonth(1).format('yyyy-MM-01') }}",
        "{{ now().plusMonths(-5).withDayOfMonth(1).format('yyyy-MM-01') }}",
        "{{ now().plusMonths(-6).withDayOfMonth(1).format('yyyy-MM-01') }}"
      ]
    }
