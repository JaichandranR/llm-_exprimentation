def test_get_backlog_partition_hours_with_ge_operator(self):
    # Use real DataFrame to prevent MagicMock issues
    df = pd.DataFrame({
        "time_hour_val": [485760, 485761, 485763, 485764],
        "partition": ["p1", "p2", "p3", "p4"]
    })

    mock_df = MockDataFrame(df)

    with patch('src.main.python.iceberg_compaction.SparkSession.table', return_value=mock_df):
        partition_hours = iceberg_compaction.get_backlog_partition_hours(
            self.mock_spark, "full_table", ["time_hour"], 485761, 485764, 3
        )
        self.assertEqual(partition_hours, [485761, 485763])
