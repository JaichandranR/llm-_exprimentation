def filter(self, condition):
    if callable(condition):
        # allow functions like lambda df: df[...] >= ...
        filtered = self.data[condition(self.data)]
    elif isinstance(condition, pd.Series):
        # allow direct boolean series
        filtered = self.data[condition]
    else:
        raise TypeError("Unsupported condition type in filter")
    return MockDataFrame(filtered)
