# ─── fetch account‐scoped catalog ID ──────────────────────────────────────────
account_id = boto3.client("sts").get_caller_identity()["Account"]
glue       = boto3.client("glue")

# ─── enable the retention optimizer (console/CFN should already have retention params) ───
glue.update_table_optimizer(
    CatalogId=account_id,
    DatabaseName=database,
    TableName=table,
    Type="retention",
    TableOptimizerConfiguration={
        "enabled": True
    }
)

# ─── trigger an on‐demand retention run ────────────────────────────────────────
glue.start_table_optimizer_run(
    CatalogId=account_id,
    DatabaseName=database,
    TableName=table,
    Type="retention"
)
