def test_prepare_sql_for_hour_with_invalid_epoch(self):
    # Provide complete set of required arguments
    catalog = "glue_catalog"
    source_db = "my_source_db"
    table_name = "my_table"
    target_file_size = 128 * 1024 * 1024  # e.g., 128MB
    invalid_epoch = -9999999

    sql = iceberg_compaction.prepare_sql_for_hour(
        catalog, source_db, table_name, target_file_size, invalid_epoch
    )

    self.assertIn("CALL", sql)
    self.assertIn("rewrite_data_files", sql)
    self.assertIn(table_name, sql)
