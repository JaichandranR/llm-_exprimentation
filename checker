package net.jpmchase.csorion;

import com.fasterxml.jackson.databind.ObjectMapper;
import net.jpmchase.csorion.message.DatasetStepFunctionDependency;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
import software.amazon.awssdk.services.ssm.SsmClient;
import software.amazon.awssdk.services.sfn.SfnClient;
import com.amazonaws.services.dynamodbv2.AmazonDynamoDBLockClient;

import java.util.List;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.mockito.Mockito.when;

class HandlerTest {

    @Mock private ObjectMapper objectMapper;
    @Mock private SsmClient ssmClient;
    @Mock private SfnClient sfnClient;
    @Mock private AmazonDynamoDBLockClient dynamoDBLockClient;

    private Handler handler;

    @BeforeEach
    void setUp() {
        MockitoAnnotations.openMocks(this);
        handler = new Handler(
            objectMapper,
            ssmClient,
            sfnClient,
            dynamoDBLockClient,
            "param1",
            "param2",
            1L,
            2L,
            "param3",
            "param4",
            "param5",
            "param6"
        );
    }

    @Test
    void testDependencyProcessing() {
        DatasetStepFunctionDependency dep = new DatasetStepFunctionDependency(
            "dataset1",
            "dep1",
            "READY",
            "FAILED",
            "uriValue",
            Integer.valueOf(1) // Integer, not int
        );

        // Replace with correct public method from Handler
        int result = handler.yourNewMethodHere(List.of(dep));

        assertEquals(400, result);
    }
}
